<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Mini Farming Game Deluxe</title>
<style>
:root{
  --accent:#00ff7f;
  --bg1:#0f1112;
  --bg2:#121212;
  --card:#161616;
  --muted:#bfc9bd;
  --glass: rgba(255,255,255,0.03);
  --radius:14px;
  --coin-color: #ffd700;
}
*{box-sizing:border-box}
html,body{height:100%;}
body{
  margin:0;
  font-family: 'Trebuchet MS', system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
  background: url('BALTI.JPG') center/cover no-repeat, radial-gradient(circle at 20% 10%, #16201a 0%, #080808 60%);
  color:#e9fff0;
  display:flex;
  align-items:flex-start;
  justify-content:center;
  padding:28px;
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
}
.container{
  width:980px;
  max-width:95vw;
  display:grid;
  grid-template-columns: 1fr 320px;
  gap:22px;
  align-items:start;
}
header{grid-column:1/-1; text-align:center}
h1{
  margin:0 0 10px 0;
  font-size:1.9rem;
  color:var(--accent);
  text-shadow:0 0 12px rgba(0,255,127,0.12);
}
.sub{color:var(--muted); margin-bottom:12px}
.panel{
  background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent);
  padding:14px;
  border-radius:var(--radius);
  border:1px solid rgba(0,255,127,0.08);
  box-shadow:0 6px 30px rgba(0,0,0,0.6), inset 0 0 30px rgba(0,255,127,0.02);
}
#canvasWrap{display:flex;flex-direction:column;gap:10px;align-items:center}
canvas{width:560px; height:560px; border-radius:12px; background:linear-gradient(180deg,#1b1b1b,#0d0d0d); box-shadow:0 0 30px rgba(0,255,127,0.06); display:block; image-rendering: pixelated;}
.controls{display:flex; gap:10px; align-items:center; flex-wrap:wrap}
.btn{cursor:pointer; border:none; padding:10px 16px; border-radius:12px; background:linear-gradient(#00ff7f,#008a4a); color:#002; font-weight:700; box-shadow:0 6px 20px rgba(0,255,127,0.08); transition:transform .12s}
.btn:active{transform:translateY(2px)}
.btn:disabled{opacity:0.5; cursor:not-allowed; background:gray;}
#infoRow{display:flex; gap:10px; width:100%; margin-top:6px; align-items:center}
.statBox{flex:1; padding:10px; background:var(--card); border-radius:10px; text-align:left}
.statTitle{font-size:0.85rem; color:var(--muted)}
.statValue{font-weight:700; font-size:1.05rem}
#side{display:flex; flex-direction:column; gap:14px}
#stats{min-height:160px}
#strainLog{max-height:220px; overflow:auto; font-size:0.92rem; color:var(--muted); padding:8px; background:var(--glass); border-radius:10px}
#breederCard{display:flex; flex-direction:column; align-items:center; gap:10px; padding:12px}
#breederCard img{width:100%; border-radius:10px; display:block}
#breederCard p{margin:0; font-weight:700; color:var(--muted)}
.xpBar{height:12px; background:rgba(255,255,255,0.04); border-radius:999px; overflow:hidden}
.xpFill{height:100%; width:0%; background:linear-gradient(90deg,var(--accent), #8affb8); transition:width 300ms ease}
.toast{position:fixed; left:50%; transform:translateX(-50%); bottom:28px; background:#09110a; padding:10px 16px; border-radius:999px; border:1px solid rgba(0,255,127,0.08); box-shadow:0 8px 30px rgba(0,0,0,0.6); display:none; z-index:99}
.backLink{display:inline-block; margin-top:12px; color:var(--muted); text-decoration:none}
#shopPanel .shopItem{display:flex; justify-content:space-between; align-items:center; margin-bottom:10px; padding:8px; background:var(--card); border-radius:10px;}
#shopPanel .shopItem button{padding:6px 12px; font-size:0.9rem;}
#achievements ul{list-style:none; padding:0; color:var(--muted);}
#achievements li{margin-bottom:6px; display:flex; align-items:center; gap:6px;}
#achievements li.unlocked{color:var(--accent);}
#confettiCanvas{position:fixed; top:0; left:0; width:100%; height:100%; pointer-events:none; z-index:100;}
@media (max-width:900px){
  .container{grid-template-columns:1fr;}
  canvas{width:100%; height:60vh}
}
</style>
</head>
<body>
<canvas id="confettiCanvas"></canvas>
<div class="container">
<header>
  <h1>üåø Mini Farming Game Deluxe</h1>
  <div class="sub">Plant seeds, watch them grow, harvest XP & earn rewards!</div>
</header>

<main class="panel" id="canvasWrap">
  <canvas id="farmCanvas" width="560" height="560" aria-label="Farm canvas"></canvas>
  <div class="controls">
    <button class="btn" id="plantBtn">üå± Plant Random Seed</button>
    <button class="btn" id="harvestBtn">üåæ Harvest Ready Plants</button>
    <button class="btn" id="fillBtn">üîÅ Fill Empty Cells</button>
    <button class="btn" id="newStartBtn">üÜï New Start</button>
    <a class="backLink" href="seite3.html">‚óÄ Back to Home</a>
  </div>
  <div id="infoRow">
    <div class="statBox">
      <div class="statTitle">Level</div>
      <div class="statValue" id="level">1</div>
    </div>
    <div class="statBox">
      <div class="statTitle">XP</div>
      <div class="statValue" id="xp">0</div>
      <div class="xpBar" style="margin-top:8px"><div id="xpFill" class="xpFill"></div></div>
    </div>
    <div class="statBox">
      <div class="statTitle">Harvested</div>
      <div class="statValue" id="harvested">0</div>
    </div>
    <div class="statBox">
      <div class="statTitle">Coins</div>
      <div class="statValue" id="coins">0</div>
    </div>
  </div>
</main>

<aside class="panel" id="side">
  <div id="stats">
    <strong>üìù Strain Log</strong>
    <div id="strainLog"></div>
  </div>

  <div id="shopPanel" class="panel">
    <strong>üè™ Shop (Rewards)</strong>
    <div id="shopItems"></div>
  </div>

  <div id="achievements" class="panel">
    <strong>üèÜ Achievements</strong>
    <ul id="achievementList"></ul>
  </div>

  <div class="panel">
    <strong>How to Play</strong>
    <ul style="padding-left:18px; margin:8px 0 0 0; color:var(--muted)">
      <li>Click a cell to plant a seed manually.</li>
      <li>Use "Plant Random Seed" for spontaneous planting.</li>
      <li>Watch plants grow over time. Harvest when golden!</li>
      <li>Earn coins and buy upgrades in the shop!</li>
    </ul>
  </div>
</aside>
</div>

<div class="toast" id="toast"></div>

<audio id="plantSound" src="plant.mp3" preload="auto"></audio>
<audio id="harvestSound" src="harvest.mp3" preload="auto"></audio>
<audio id="levelUpSound" src="levelup.mp3" preload="auto"></audio>

<script>
// -------------------
// Config & State
// -------------------
const GRID_SIZE = 5;
let strains = [
  {name: "Sticky Buns", color: "#8EE28E", growRate: 6, xp: 12, coins: 5, unlocked: true},
  {name: "Pink Berry Pop", color: "#E6F39B", growRate: 8, xp: 9, coins: 4, unlocked: true},
  {name: "Boom Boom Berry", color: "#6FD08A", growRate: 4.5, xp: 15, coins: 7, unlocked: true},
  {name: "White Rhino", color: "#DFF7D6", growRate: 7, xp: 10, coins: 5, unlocked: true},
  {name: "Golden Kush", color: "#FFD700", growRate: 5, xp: 20, coins: 10, unlocked: false, unlockLevel: 3},
  {name: "Purple Haze", color: "#A020F0", growRate: 9, xp: 8, coins: 6, unlocked: false, unlockLevel: 5}
];
const upgrades = [
  {id: "growthBoost", name: "Growth Boost", desc: "+20% Grow Rate", cost: 30, level: 0, maxLevel: 3, effect: () => growthMultiplier += 0.2},
  {id: "xpBoost", name: "XP Boost", desc: "+10% XP per Harvest", cost: 50, level: 0, maxLevel: 3, effect: () => xpMultiplier += 0.1},
  {id: "coinBoost", name: "Coin Boost", desc: "+15% Coins per Harvest", cost: 40, level: 0, maxLevel: 3, effect: () => coinMultiplier += 0.15},
  {id: "autoPlant", name: "Auto Planter", desc: "Automatically plants empty cells slowly", cost: 80, level: 0, maxLevel: 1, effect: () => autoPlantUnlocked = true}
];
const achievements = [
  {id: "firstHarvest", name: "First Harvest", desc: "Harvest your first plant", unlocked: false, condition: () => harvested >= 1},
  {id: "level5", name: "Level 5 Achieved", desc: "Reach Level 5", unlocked: false, condition: () => level >= 5},
  {id: "harvest100", name: "100 Harvests", desc: "Harvest 100 plants", unlocked: false, condition: () => harvested >= 100},
  {id: "allUpgrades", name: "Master Upgrader", desc: "Buy all upgrades maxed", unlocked: false, condition: () => upgrades.every(u => u.level >= u.maxLevel)}
];
const canvas = document.getElementById('farmCanvas');
const ctx = canvas.getContext('2d');
const confettiCanvas = document.getElementById('confettiCanvas');
const confettiCtx = confettiCanvas.getContext('2d');
let farm = Array.from({length: GRID_SIZE}, () => Array(GRID_SIZE).fill(null));
let xp = 0, level = 1, harvested = 0, coins = 100;
let growthMultiplier = 1, xpMultiplier = 1, coinMultiplier = 1, autoPlantUnlocked = false;
let lastAutoPlant = 0;
let confettiParticles = [];

// -------------------
// Classes
// -------------------
class Plant {constructor(strain){this.strain=strain;this.growth=0;this.particles=[];this.sway=Math.random()*Math.PI*2;} grow(dt){if(this.growth<100){this.growth=Math.min(100,this.growth+this.strain.growRate*growthMultiplier*(dt/1000));}else if(Math.random()<0.06){this.particles.push(new Spark());}this.particles.forEach(p=>p.update(dt));this.particles=this.particles.filter(p=>!p.dead);} isReady(){return this.growth>=100;}}
class Spark{constructor(){this.x=0;this.y=0;this.vx=(Math.random()-0.5)*0.6;this.vy=-Math.random()*0.8-0.2;this.life=700+Math.random()*700;this.age=0;this.dead=false;} update(dt){this.x+=this.vx*dt;this.y+=this.vy*dt;this.age+=dt;if(this.age>=this.life)this.dead=true;}}

// -------------------
// Drawing
// -------------------
function drawFarm(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  const cellSize = canvas.width/GRID_SIZE;
  for(let y=0;y<GRID_SIZE;y++){
    for(let x=0;x<GRID_SIZE;x++){
      let plant = farm[y][x];
      ctx.strokeStyle="#333";
      ctx.strokeRect(x*cellSize,y*cellSize,cellSize,cellSize);
      if(plant){
        let h = cellSize*(plant.growth/100);
        ctx.fillStyle = plant.strain.color;
        ctx.fillRect(x*cellSize,y*cellSize+cellSize-h,cellSize,h);
      }
    }
  }
}
function drawConfetti(){
  confettiCtx.clearRect(0,0,confettiCanvas.width,confettiCanvas.height);
  confettiParticles.forEach(p=>{
    confettiCtx.fillStyle=p.color;
    confettiCtx.fillRect(p.x,p.y,p.size,p.size);
    p.y += p.vy; p.x += p.vx; p.vy += 0.03; if(p.y>confettiCanvas.height){p.y=-10;}
  });
  confettiParticles = confettiParticles.filter(p=>p.age-- >0);
}

// -------------------
// Game Logic
// -------------------
function plantRandom(){let emptyCells=[];for(let y=0;y<GRID_SIZE;y++)for(let x=0;x<GRID_SIZE;x++)if(!farm[y][x])emptyCells.push([x,y]);if(emptyCells.length===0)return;let [x,y]=emptyCells[Math.floor(Math.random()*emptyCells.length)];let available = strains.filter(s=>s.unlocked);let strain = available[Math.floor(Math.random()*available.length)];farm[y][x]=new Plant(strain);showToast(`Planted ${strain.name}!`);}
function harvest(){for(let y=0;y<GRID_SIZE;y++){for(let x=0;x<GRID_SIZE;x++){let p=farm[y][x];if(p&&p.isReady()){xp+=p.strain.xp*xpMultiplier;coins+=p.strain.coins*coinMultiplier;harvested++;showToast(`Harvested ${p.strain.name}! +${p.strain.xp} XP`);farm[y][x]=null;}}} updateUI(); checkAchievements(); }
function updateUI(){document.getElementById('xp').textContent=Math.floor(xp); document.getElementById('level').textContent=level; document.getElementById('harvested').textContent=harvested; document.getElementById('coins').textContent=Math.floor(coins); let xpFill = document.getElementById('xpFill'); xpFill.style.width=Math.min(100,(xp/levelThreshold())*100)+'%';}
function levelThreshold(){return 100 + level*25;}
function checkLevel(){while(xp>=levelThreshold()){xp-=levelThreshold();level++; showToast(`Level Up! You reached Level ${level}!`); unlockStrains(); playSound('levelUpSound'); updateUI(); }}
function unlockStrains(){strains.forEach(s=>{if(!s.unlocked && s.unlockLevel<=level){s.unlocked=true; showToast(`New Strain Unlocked: ${s.name}!`); playConfetti();}});}
function checkAchievements(){achievements.forEach(a=>{if(!a.unlocked && a.condition()){a.unlocked=true; addAchievement(a.name); playConfetti();}});}
function addAchievement(name){const li=document.createElement('li'); li.textContent=name; li.classList.add('unlocked'); document.getElementById('achievementList').appendChild(li);}
function showToast(msg){const t=document.getElementById('toast'); t.textContent=msg; t.style.display='block'; setTimeout(()=>{t.style.display='none'},2200);}
function playSound(id){let s=document.getElementById(id); if(s)s.play();}
function playConfetti(){for(let i=0;i<60;i++){confettiParticles.push({x:Math.random()*confettiCanvas.width,y:Math.random()*confettiCanvas.height, vx:(Math.random()-0.5)*3, vy:Math.random()*-3-1, size:4+Math.random()*4, color:`hsl(${Math.random()*360},70%,60%)`, age:100+Math.random()*50});}}

// -------------------
// Shop
// -------------------
function renderShop(){
  const container=document.getElementById('shopItems');
  container.innerHTML='';
  upgrades.forEach(u=>{
    const div=document.createElement('div');
    div.classList.add('shopItem');
    div.innerHTML=`<div><strong>${u.name}</strong><br><small>${u.desc} (Lv ${u.level})</small></div><button ${coins<u.cost?'disabled':''}>Buy ${u.cost} üí∞</button>`;
    div.querySelector('button').onclick=()=>{
      if(coins>=u.cost && u.level<u.maxLevel){coins-=u.cost; u.level++; u.effect(); renderShop(); updateUI(); showToast(`${u.name} Upgraded!`);}
    };
    container.appendChild(div);
  });
}

// -------------------
// Auto Plant
// -------------------
function autoPlant(dt){if(!autoPlantUnlocked)return; lastAutoPlant+=dt; if(lastAutoPlant>4000){plantRandom(); lastAutoPlant=0;}}

// -------------------
// Event Listeners
// -------------------
document.getElementById('plantBtn').onclick=plantRandom;
document.getElementById('harvestBtn').onclick=harvest;
document.getElementById('fillBtn').onclick=()=>{for(let y=0;y<GRID_SIZE;y++)for(let x=0;x<GRID_SIZE;x++)if(!farm[y][x])plantRandom();};
document.getElementById('newStartBtn').onclick=()=>{xp=0;level=1;harvested=0;coins=100;farm=Array.from({length: GRID_SIZE}, ()=>Array(GRID_SIZE).fill(null)); updateUI(); showToast("New Game Started!");};

// -------------------
// Canvas Click Planting
// -------------------
canvas.addEventListener('click',(e)=>{
  const rect = canvas.getBoundingClientRect();
  const x = Math.floor((e.clientX-rect.left)/(rect.width/GRID_SIZE));
  const y = Math.floor((e.clientY-rect.top)/(rect.height/GRID_SIZE));
  if(!farm[y][x]){let available=strains.filter(s=>s.unlocked);farm[y][x]=new Plant(available[Math.floor(Math.random()*available.length)]); showToast(`Planted manually!`);}
});

// -------------------
// Main Loop
// -------------------
let lastTime=performance.now();
function loop(t){
  const dt = t-lastTime; lastTime=t;
  farm.flat().filter(p=>p).forEach(p=>p.grow(dt));
  drawFarm(); drawConfetti();
  autoPlant(dt); checkLevel();
  requestAnimationFrame(loop);
}
updateUI(); renderShop(); requestAnimationFrame(loop);
</script>
</body>
</html>
