<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Mini Farming Game Deluxe</title>
<style>
:root{
  --accent:#00ff7f;
  --bg1:#0f1112;
  --bg2:#121212;
  --card:#161616;
  --muted:#bfc9bd;
  --glass: rgba(255,255,255,0.03);
  --radius:14px;
  --coin-color: #ffd700;
}
*{box-sizing:border-box}
html,body{height:100%;}
body{
  margin:0;
  font-family: 'Trebuchet MS', system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
  background: url('BALTI.JPG') center/cover no-repeat, radial-gradient(circle at 20% 10%, #16201a 0%, #080808 60%);
  color:#e9fff0;
  display:flex;
  align-items:flex-start;
  justify-content:center;
  padding:28px;
}
.container{
  width:980px;
  max-width:95vw;
  display:grid;
  grid-template-columns: 1fr 320px;
  gap:22px;
  align-items:start;
}
header{grid-column:1/-1; text-align:center}
h1{
  margin:0 0 10px 0;
  font-size:1.9rem;
  color:var(--accent);
  text-shadow:0 0 12px rgba(0,255,127,0.12);
}
.sub{color:var(--muted); margin-bottom:12px}
.panel{
  background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent);
  padding:14px;
  border-radius:var(--radius);
  border:1px solid rgba(0,255,127,0.08);
  box-shadow:0 6px 30px rgba(0,0,0,0.6), inset 0 0 30px rgba(0,255,127,0.02);
}
#canvasWrap{display:flex;flex-direction:column;gap:10px;align-items:center}
canvas{width:560px; height:560px; border-radius:12px; background:linear-gradient(180deg,#1b1b1b,#0d0d0d); box-shadow:0 0 30px rgba(0,255,127,0.06); display:block; image-rendering: pixelated;}
.controls{display:flex; gap:10px; align-items:center; flex-wrap:wrap}
.btn{cursor:pointer; border:none; padding:10px 16px; border-radius:12px; background:linear-gradient(#00ff7f,#008a4a); color:#002; font-weight:700; box-shadow:0 6px 20px rgba(0,255,127,0.08); transition:transform .12s}
.btn:active{transform:translateY(2px)}
.btn:disabled{opacity:0.5; cursor:not-allowed; background:gray;}
#infoRow{display:flex; gap:10px; width:100%; margin-top:6px; align-items:center}
.statBox{flex:1; padding:10px; background:var(--card); border-radius:10px; text-align:left}
.statTitle{font-size:0.85rem; color:var(--muted)}
.statValue{font-weight:700; font-size:1.05rem}
#side{display:flex; flex-direction:column; gap:14px}
#stats{min-height:160px}
#strainLog{max-height:220px; overflow:auto; font-size:0.92rem; color:var(--muted); padding:8px; background:var(--glass); border-radius:10px}
#breederCard{display:flex; flex-direction:column; align-items:center; gap:10px; padding:12px}
#breederCard img{width:100%; border-radius:10px; display:block}
#breederCard p{margin:0; font-weight:700; color:var(--muted)}
.xpBar{height:12px; background:rgba(255,255,255,0.04); border-radius:999px; overflow:hidden}
.xpFill{height:100%; width:0%; background:linear-gradient(90deg,var(--accent), #8affb8); transition:width 300ms ease}
.toast{position:fixed; left:50%; transform:translateX(-50%); bottom:28px; background:#09110a; padding:10px 16px; border-radius:999px; border:1px solid rgba(0,255,127,0.08); box-shadow:0 8px 30px rgba(0,0,0,0.6); display:none; z-index:999}
.backLink{display:inline-block; margin-top:12px; color:var(--muted); text-decoration:none}
#shopPanel .shopItem{display:flex; justify-content:space-between; align-items:center; margin-bottom:10px; padding:8px; background:var(--card); border-radius:10px;}
#shopPanel .shopItem button{padding:6px 12px; font-size:0.9rem;}
#achievements ul{list-style:none; padding:0; color:var(--muted);}
#achievements li{margin-bottom:6px; display:flex; align-items:center; gap:6px;}
#achievements li.unlocked{color:var(--accent);}
#confettiCanvas{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:9999}
@media (max-width:900px){
  .container{grid-template-columns:1fr;}
  canvas{width:100%; height:60vh}
}
</style>
</head>
<body>
<canvas id="confettiCanvas"></canvas>
<div class="container">
<header>
  <h1>üåø Mini Farming Game Deluxe</h1>
  <div class="sub">Plant seeds, watch them grow and harvest for XP & rewards!</div>
</header>

<main class="panel" id="canvasWrap">
  <canvas id="farmCanvas" width="560" height="560" aria-label="Farm canvas"></canvas>
  <div class="controls">
    <button class="btn" id="plantBtn">üå± Plant Random Seed</button>
    <button class="btn" id="harvestBtn">üåæ Harvest Ready Plants</button>
    <button class="btn" id="fillBtn">üîÅ Fill Empty Fields</button>
    <button class="btn" id="newStartBtn">üÜï New Start</button>
    <div style="flex:1"></div>
    <a class="backLink" href="seite3.html">‚óÄ Back To Home</a>
  </div>
  <div id="infoRow">
    <div class="statBox">
      <div class="statTitle">Level</div>
      <div class="statValue" id="level">1</div>
    </div>
    <div class="statBox">
      <div class="statTitle">XP</div>
      <div class="statValue" id="xp">0</div>
      <div class="xpBar" style="margin-top:8px"><div id="xpFill" class="xpFill"></div></div>
    </div>
    <div class="statBox">
      <div class="statTitle">Harvested</div>
      <div class="statValue" id="harvested">0</div>
    </div>
    <div class="statBox">
      <div class="statTitle">Coins</div>
      <div class="statValue" id="coins">0</div>
    </div>
  </div>
</main>

<aside class="panel" id="side">
  <div id="stats">
    <strong>üìù Strain Log</strong>
    <div id="strainLog"></div>
  </div>

  <div id="shopPanel" class="panel">
    <strong>üè™ Shop (Rewards)</strong>
    <div id="shopItems"></div>
  </div>

  <div id="achievements" class="panel">
    <strong>üèÜ Achievements</strong>
    <ul id="achievementList"></ul>
  </div>

  <div class="panel">
    <strong>How To Play</strong>
    <ul style="padding-left:18px; margin:8px 0 0 0; color:var(--muted)">
      <li>Click a cell to plant a seed.</li>
      <li>Use "Plant Random Seed" for auto placement.</li>
      <li>Plants grow over time. Harvest when golden.</li>
      <li>Earn coins and buy upgrades in the Shop!</li>
    </ul>
  </div>
</aside>
</div>

<div class="toast" id="toast"></div>

<audio id="plantSound" src="plant.mp3" preload="auto"></audio>
<audio id="harvestSound" src="harvest.mp3" preload="auto"></audio>
<audio id="levelUpSound" src="levelup.mp3" preload="auto"></audio>

<script>
// -------------------
// Config & State
// -------------------
const GRID_SIZE = 5;
let strains = [
  {name:"Sticky Buns", color:"#8EE28E", growRate:6, xp:12, coins:5, unlocked:true},
  {name:"Pink Berry Pop", color:"#E6F39B", growRate:8, xp:9, coins:4, unlocked:true},
  {name:"Boom Boom Berry", color:"#6FD08A", growRate:4.5, xp:15, coins:7, unlocked:true},
  {name:"White Rhino", color:"#DFF7D6", growRate:7, xp:10, coins:5, unlocked:true},
  {name:"Golden Kush", color:"#FFD700", growRate:5, xp:20, coins:10, unlocked:false, unlockLevel:3},
  {name:"Purple Haze", color:"#A020F0", growRate:9, xp:8, coins:6, unlocked:false, unlockLevel:5}
];
const upgrades = [
  {id:"growthBoost", name:"Growth Boost", desc:"+20% Growth Rate", cost:30, level:0, maxLevel:3, effect:()=>growthMultiplier+=0.2},
  {id:"xpBoost", name:"XP Boost", desc:"+10% XP per Harvest", cost:50, level:0, maxLevel:3, effect:()=>xpMultiplier+=0.1},
  {id:"coinBoost", name:"Coin Boost", desc:"+15% Coins per Harvest", cost:40, level:0, maxLevel:3, effect:()=>coinMultiplier+=0.15},
  {id:"autoPlant", name:"Auto-Planter", desc:"Automatically plants empty cells (slow)", cost:80, level:0, maxLevel:1, effect:()=>autoPlantUnlocked=true}
];
const achievements = [
  {id:"firstHarvest", name:"First Harvest", desc:"Harvest your first plant", unlocked:false, condition:()=>harvested>=1},
  {id:"level5", name:"Level 5 Reached", desc:"Reach Level 5", unlocked:false, condition:()=>level>=5},
  {id:"harvest100", name:"100 Harvests", desc:"Harvest 100 plants", unlocked:false, condition:()=>harvested>=100},
  {id:"allUpgrades", name:"Master Upgrader", desc:"Buy all upgrades max.", unlocked:false, condition:()=>upgrades.every(u=>u.level>=u.maxLevel)}
];
const canvas = document.getElementById('farmCanvas');
const ctx = canvas.getContext('2d');
const farm = Array.from({length:GRID_SIZE},()=>Array(GRID_SIZE).fill(null));
let xp=0, level=1, harvested=0, coins=100;
let growthMultiplier=1, xpMultiplier=1, coinMultiplier=1, autoPlantUnlocked=false;
let lastAutoPlant=0;

// -------------------
// Classes
// -------------------
class Plant{
  constructor(strain){
    this.strain=strain;
    this.growth=0;
    this.particles=[];
    this.sway=Math.random()*Math.PI*2;
  }
  grow(dt){
    if(this.growth<100) this.growth=Math.min(100,this.growth+this.strain.growRate*growthMultiplier*(dt/1000));
    else if(Math.random()<0.06) this.particles.push(new Spark());
  }
}
class Spark{
  constructor(){
    this.x=0;
    this.y=0;
    this.vx=(Math.random()-0.5)*0.6;
    this.vy=-Math.random()*0.8-0.2;
    this.life=700+Math.random()*700;
    this.age=0;
    this.dead=false;
  }
  update(dt){
    this.x+=this.vx*dt;
    this.y+=this.vy*dt;
    this.age+=dt;
    if(this.age>=this.life) this.dead=true;
  }
}

// -------------------
// Helpers
// -------------------
function drawFarm(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  const cellW = canvas.width/GRID_SIZE;
  const cellH = canvas.height/GRID_SIZE;
  for(let y=0;y<GRID_SIZE;y++){
    for(let x=0;x<GRID_SIZE;x++){
      const plant = farm[y][x];
      ctx.strokeStyle="#333";
      ctx.strokeRect(x*cellW,y*cellH,cellW,cellH);
      if(plant){
        const size=cellW*0.5*(plant.growth/100);
        const cx=x*cellW+cellW/2+Math.sin(plant.sway)*4;
        const cy=y*cellH+cellH/2;
        ctx.fillStyle=plant.strain.color;
        ctx.beginPath();
        ctx.arc(cx,cy,size,0,2*Math.PI);
        ctx.fill();
        plant.sway+=0.02;

        // particles
        plant.particles.forEach(p=>{
          ctx.fillStyle="rgba(255,255,255,0.8)";
          ctx.fillRect(cx+p.x,cy+p.y,2,2);
        });
        plant.particles = plant.particles.filter(p=>!p.dead);
      }
    }
  }
}
function addXP(amount){
  xp+=amount*xpMultiplier;
  checkLevel();
}
function checkLevel(){
  const req = 50 + level*50;
  if(xp>=req){
    xp-=req;
    level++;
    playSound("levelUpSound");
    showToast(`Level Up! üåü Level ${level}`);
    checkAchievements();
  }
  document.getElementById('xp').textContent=Math.floor(xp);
  document.getElementById('level').textContent=level;
  document.getElementById('xpFill').style.width=Math.min(100,(xp/req)*100)+'%';
}
function showToast(msg){
  const t=document.getElementById('toast');
  t.textContent=msg;
  t.style.display="block";
  setTimeout(()=>t.style.display="none",1500);
}
function playSound(id){
  const s=document.getElementById(id);
  if(s) s.currentTime=0, s.play();
}
function harvestPlant(x,y){
  const plant=farm[y][x];
  if(plant && plant.growth>=100){
    addXP(plant.strain.xp);
    coins+=plant.strain.coins*coinMultiplier;
    harvested++;
    farm[y][x]=null;
    playSound("harvestSound");
    updateStats();
    checkAchievements();
    showConfetti();
    logStrain(plant.strain.name);
  }
}
function updateStats(){
  document.getElementById('coins').textContent=Math.floor(coins);
  document.getElementById('harvested').textContent=harvested;
}
function logStrain(name){
  const log=document.getElementById('strainLog');
  log.innerHTML=`${name} harvested!<br>`+log.innerHTML;
}
function checkAchievements(){
  achievements.forEach(a=>{
    if(!a.unlocked && a.condition()){
      a.unlocked=true;
      const li=document.querySelector(`#achievementList li[data-id="${a.id}"]`);
      if(li) li.classList.add('unlocked');
      showToast(`Achievement unlocked: ${a.name} üèÜ`);
      showConfetti();
    }
  });
}
function showConfetti(){
  for(let i=0;i<30;i++) confetti.push(new Spark());
}

// -------------------
// Shop
// -------------------
function renderShop(){
  const shopDiv=document.getElementById('shopItems');
  shopDiv.innerHTML="";
  upgrades.forEach(u=>{
    const div=document.createElement('div');
    div.className="shopItem";
    div.innerHTML=`<div>${u.name} (${u.level}/${u.maxLevel})<br><small>${u.desc}</small></div>`;
    const btn=document.createElement('button');
    btn.textContent="Buy "+u.cost;
    btn.disabled=(coins<u.cost || u.level>=u.maxLevel);
    btn.onclick=()=>{
      if(coins>=u.cost && u.level<u.maxLevel){
        coins-=u.cost;
        u.level++;
        u.effect();
        renderShop();
        updateStats();
        showToast(`${u.name} upgraded!`);
      }
    }
    div.appendChild(btn);
    shopDiv.appendChild(div);
  });
}

// -------------------
// Init Achievements List
// -------------------
function renderAchievements(){
  const list=document.getElementById('achievementList');
  achievements.forEach(a=>{
    const li=document.createElement('li');
    li.textContent=a.name;
    li.dataset.id=a.id;
    list.appendChild(li);
  });
}

// -------------------
// Canvas Interaction
// -------------------
canvas.addEventListener('click', e=>{
  const rect=canvas.getBoundingClientRect();
  const x=Math.floor((e.clientX-rect.left)/(rect.width/GRID_SIZE));
  const y=Math.floor((e.clientY-rect.top)/(rect.height/GRID_SIZE));
  if(farm[y][x]==null){
    const available=strains.filter(s=>s.unlocked);
    const seed=available[Math.floor(Math.random()*available.length)];
    farm[y][x]=new Plant(seed);
    playSound("plantSound");
  } else {
    harvestPlant(x,y);
  }
});

// -------------------
// Button Events
// -------------------
document.getElementById('plantBtn').addEventListener('click',()=>{
  const empty=[];
  farm.forEach((row,y)=>row.forEach((p,x)=>{if(!p) empty.push([x,y])}));
  if(empty.length>0){
    const [x,y]=empty[Math.floor(Math.random()*empty.length)];
    const seed=strains.filter(s=>s.unlocked)[Math.floor(Math.random()*strains.filter(s=>s.unlocked).length)];
    farm[y][x]=new Plant(seed);
    playSound("plantSound");
  }
});
document.getElementById('harvestBtn').addEventListener('click',()=>{
  farm.forEach((row,y)=>row.forEach((p,x)=>{if(p && p.growth>=100) harvestPlant(x,y)}));
});
document.getElementById('fillBtn').addEventListener('click',()=>{
  farm.forEach((row,y)=>row.forEach((p,x)=>{if(!p) farm[y][x]=new Plant(strains.filter(s=>s.unlocked)[Math.floor(Math.random()*strains.filter(s=>s.unlocked).length)])}));
});
document.getElementById('newStartBtn').addEventListener('click',()=>{if(confirm("Start over?")) location.reload();});

// -------------------
// Auto-Plant
// -------------------
function autoPlant(dt){
  lastAutoPlant+=dt;
  if(autoPlantUnlocked && lastAutoPlant>5000){
    const empty=[];
    farm.forEach((row,y)=>row.forEach((p,x)=>{if(!p) empty.push([x,y])}));
    if(empty.length>0){
      const [x,y]=empty[Math.floor(Math.random()*empty.length)];
      const seed=strains.filter(s=>s.unlocked)[Math.floor(Math.random()*strains.filter(s=>s.unlocked).length)];
      farm[y][x]=new Plant(seed);
      playSound("plantSound");
      lastAutoPlant=0;
    }
  }
}

// -------------------
// Confetti Canvas
// -------------------
const confettiCanvas = document.getElementById('confettiCanvas');
const confettiCtx = confettiCanvas.getContext('2d');
let confetti=[];
function drawConfetti(dt){
  confettiCtx.clearRect(0,0,confettiCanvas.width,confettiCanvas.height);
  confetti.forEach(c=>{
    c.update(dt);
    confettiCtx.fillStyle="rgba(255,215,0,0.9)";
    confettiCtx.fillRect(c.x+Math.random()*560,c.y+Math.random()*560,2,2);
  });
  confetti = confetti.filter(c=>!c.dead);
}

// -------------------
// Animation Loop
// -------------------
let last=performance.now();
function loop(t){
  const dt=t-last;
  last=t;
  farm.forEach(row=>row.forEach(p=>{if(p) p.grow(dt)}));
  drawFarm();
  drawConfetti(dt);
  autoPlant(dt);
  requestAnimationFrame(loop);
}
loop(performance.now());

// -------------------
// Initialize
// -------------------
renderShop();
renderAchievements();
updateStats();

</script>
</body>
</html>
